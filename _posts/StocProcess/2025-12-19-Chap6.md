---
layout: post
title: Chapter6-Markov Chain with continuous parameters
permalink: /StocProcess/Chap6
toc: true
---

# 连续参数 Markov 链
## 定义及基本概念
### 连续参数 Markov 链与状态转移矩阵
离散参数 Markov 链是离散时间步到离散状态空间的映射，考虑到现实中时间在宏观尺度下的描述是连续的，很自然想到需要将 Markov 链的定义推广至连续时间步下以适应更多的应用场景.

Markov 链最重要的是其马氏性，因而连续参数马尔可夫链依然保有这个特性. 状态空间仍保证可列性，仅将离散时间步做拓展，得到以下定义：

> **Definition 6.1 (连续参数 Markov 链)** 设随机过程 $X = \\{ X(t), t \geq 0 \\}$，状态空间为 $S$. 对任意 $0 \leq t\_0 < t\_1 < \cdots < t\_n < t\_{n+1}, i\_k \in S, 0 \leq k \leq n + 1$，若 $P\\{ X(t\_i) = i\_i, 0 \leq i \leq n, i \in \mathbb{Z}\\} > 0$，有
> 
> $$
> \begin{aligned}
>   P\{ X(t\_{n+1}) &= i_{n+1} | X(t_0) = i_0, \cdots, X(t_n) = i_n \} \\
    &= P\{ X(t_{n+1}) = i_{n+1} | X(t_n) = i_n \}
> \end{aligned}
> $$
> 
> 则称 $\\{ X(t), t \geq 0 \\}$ 为 **连续参数 Markov 链**，简称连续参数马氏链. 

可以类比离散状态给出转移概率矩阵

$$
    \bm{P}(t) = \left(P_{ij}(t) \right), \hspace{1ex} i, j \in S
$$

其中元素 $P\_{ij}$ 依然满足与离散参数 Markov 链相同的性质：
- $P\_{ij} \geq 0, \sum\_{j\in S} P_{ij}(t) = 1 \hspace{1ex} i, j \in S$.
- C-K 方程：$P\_{ij}(s+t) = \sum\_{k \in S} P\_{ik} (s) P\_{kj}(t), \hspace{1ex} s, t \geq 0, i, j \in S$，矩阵形式为
 
$$
    \bm{P}(s, t) = \bm{P}(s)\bm{P}(t)
$$

- $P_{ij}(0) = \delta_{ij}$，矩阵形式为 $\bm{P}(0) = \bm{I}$.

由于连续时间步下 $t$ 可以取得无穷小，因而需要保证概率函数在 $t=0$ 处的连续性，我们规定有标准型条件：

$$
    \lim_{t \to 0} P_{ij}(t) = \delta_{ij} \text{ or } \lim_{t \to 0} \bm{P}(t) = \bm{I}
$$

这也就是说，在 $t \to 0$ 时，状态 $i$ 转移到其他状态的概率为 0, 即在无穷小时间跨度下状态保持稳定. 有了这个连续性条件，转移概率矩阵就有一些很好的性质.

> **Proposition 6.1** 设 $\bm{P}(t) = (P\_{ij}(t))$ 为标准性转移概率矩阵，即满足标准性条件，则
> - $\forall i \in S, P\_{ij}(t)$ 在 $[0, \infty)$ 上一致连续;
> - $\forall t \geq 0, i \in S, P\_{ii}(t) > 0$.

先来证明第一个命题，任取 $t\_1, t\_2 \geq 0$，不妨认为 $t\_2 \geq t\_1$，记 $h = t\_2 - t\_1 \geq 0$，则有

$$
\begin{aligned}
    P_{ij}(t_2) - P_{ij}(t_1) &= P_{ij}(t_1 + h) - P_{ij}(t_1) \\
    &= \sum_{k \in S} P_{ik}(t_1) P_{kj}(h) - P_{ij}(t_1) \\
    &= \sum_{k \neq j} P_{ik}(t_1) P_{kj}(h) - P_{ij}(t_1)(1 - P_{jj}(h)) 
\end{aligned}
$$

考虑到等号右侧两项均为正数，以及概率总是落在 $[0, 1]$ 区间内，则有

$$
    P_{ij}(t_2) - P_{ij}(t_1) \leq \sum_{k \neq j} P_{kj}(h) = 1 - P_{jj}(h) \\
    P_{ij}(t_2) - P_{ij}(t_1) \geq -(1 - P_{jj}(h))
$$

依据标准性条件，当 $h \to 0$ 时 $P_{jj}(h) \to 1$，对上式取绝对值同时取极限即可得到

$$
    \lim_{h \to 0} | P_{ij}(t_2) - P_{ij}(t_1) | \leq \lim_{h \to 0} \left(1 - P_{jj}(h)\right) = 0
$$

即 $\lim\_{h \to 0} \| P\_{ij}(t\_2) - P\_{ij}(t\_1) \| = 0$，说明 $P_{ij}(t)$ 在 $[0, \infty)$ 上是一致连续的.

第二点则可以通过等分得到，对取定的 $t \geq 0$，可将 $[0, t)$ 做 $n$ 等分，切割点为 $\\{ m\_i = \frac{it}{n}, 1 \leq i \leq n - 1 \\}$，对于每个切割点都有

$$
    P_{ii}\left(m_i + \frac{t}{n}\right) = \sum_{k \in S} P_{ik}(m_i)P_{ki}\left(\frac{t}{n} \right) \geq P_{ii}(m_i)P_{ii} \left( \frac{t}{n} \right)
$$

递推很快得到 $P\_{ii}(t) \geq P\_{ii}(0)P\_{ii}\left( \frac{t}{n} \right)^{n}$，取极限 $n \to \infty$ 再利用标准性条件很快就可以得到 $P\_{ii}(t) \geq 0$.

### 状态之间的关系
参照离散参数 Markov 链的表示，连续参数 Markov 链也可以用一个向量 $\bm{\pi}(t)$ 来表示在某个时间点状态分布

$$
    \bm{\pi}(t) = (\pi_i(t), i \in S), \hspace{1ex} \pi_t(t) = P(X(t) = i), t \geq 0
$$

同样地，已知一条连续参数 Markov 链的初始状态 $\bm{\pi}(0)$ 以及后续时刻的转移矩阵 $\bm{P}(t)$，可以唯一确定后续时刻对应的状态. 在连续参数 Markov 链 $X = \\{ X(t), t \geq 0\\}$ 中取定 $h > 0$，定义 $X\_n(h) = X(nh), n \geq 0$，很容易发现 $\\{ X\_n(h), n \geq 0\\}$ 是一条离散参数 Markov 链，其时间步为 $h$，因而这条链被称为以 $h$ 为步长的 $\bm{h-}$**离散骨架**，简称 $h$ 骨架. 这是一个很有意思的视角，其将连续参数 Markov 链重新转回离散时间 Markov 链的研究中，大幅简化连续参数 Markov 链变换过程. 不过我们目前暂时用不到，先按下不表，待用到我们再回来.

状态可达的定义仍然没有改变：

> **Definition 6.2 (状态可达)** 设 $i, j \in S$，$\bm{P} = (P\_{ij})$ 为转移概率矩阵，若存在 $t > 0, P\_{ij}(t) > 0$，则称状态 $i$ 可达状态 $j$，记作 $i \to j$. 若 $\forall t > 0, P\_{ij}(t) = 0$，则称状态 $i$ 不可达状态 $j$，记作 $i \nrightarrow j$.
> 
> 若 $i \to j$ 且 $j \to i$，则称状态 $i, j$ 相通，记作 $i \leftrightarrow j$.

基于相通关系相应可以定义状态等价类、常返态等概念. 然而利用前面证明的 $P\_{ij}(t)$ 的一致连续性，以及离散 Markov 链的一些定理，有以下命题：

> **Proposition 6.2** 任意 $i, j \in S$，极限
> 
> $$
>   \lim_{t \to \infty} P_{ij}(t) = \pi_{ij}
> $$
> 
> 总存在.

